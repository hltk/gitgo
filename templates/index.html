{{template "header.html" . -}}
<div class="two-column-container">
<div class="main-content">
<div id="nav-clone-container" style="display: flex; align-items: center; justify-content: space-between; gap: 2rem; padding: 1rem; border: 1px solid black; border-radius: 6px; margin-bottom: 1rem;">
<div id="nav" style="display: flex; gap: 1rem; align-items: center; border: none; margin: 0;">
{{range .GlobalData.Links -}}
{{if and (ne .Pretty "tree") (ne .Pretty "log") -}}
{{if eq .Pretty "branches" -}}
<a href="/{{$.GlobalData.Config.RepoName -}}{{.Link}}">{{.Pretty}} ({{$.GlobalData.BranchCount}})</a>
{{else if eq .Pretty "tags" -}}
<a href="/{{$.GlobalData.Config.RepoName -}}{{.Link}}">{{.Pretty}} ({{$.GlobalData.TagCount}})</a>
{{else -}}
<a href="/{{$.GlobalData.Config.RepoName -}}{{.Link}}">{{.Pretty}}</a>
{{end -}}
{{end -}}
{{end -}}
</div>
<div id="cloneurl" style="display: flex; align-items: center; gap: 0.5rem; border: none; margin: 0;">
<span style="font-weight: 600; margin-right: 0.5rem;">Clone:</span>
<code class="clone-url" style="border: none; background: none;">git clone git://{{.GlobalData.Config.GitUrl}}/{{.GlobalData.Config.RepoName}}</code>
<button class="copy-btn" onclick="copyCloneUrl(this)">Copy</button>
</div>
</div>
<script>
function copyCloneUrl(btn) {
    const url = "git clone git://{{.GlobalData.Config.GitUrl}}/{{.GlobalData.Config.RepoName}}";
    navigator.clipboard.writeText(url).then(() => {
        btn.textContent = 'Copied!';
        btn.style.color = '#28a745';
        setTimeout(() => {
            btn.textContent = 'Copy';
            btn.style.color = '';
        }, 2000);
    });
}
</script>
{{if .CommitFound -}}
<div id="latestcommit">
<div style="display: flex; justify-content: space-between; align-items: center; padding: 1em;">
<div>
<h3 style="margin-bottom: 0.5em;">Latest commit</h3>
<p style="margin: 0;">
<a href="/{{$.GlobalData.Config.RepoName}}{{.LatestCommit.Link}}">{{.LatestCommit.Msg}}</a>
<br>
<small>by {{.LatestCommit.Name}} on {{formatDate .LatestCommit.Date}}</small>
</p>
</div>
<div id="loglink">
{{range .GlobalData.Links -}}
{{if eq .Pretty "log" -}}
<a href="/{{$.GlobalData.Config.RepoName -}}{{.Link}}">View all commits ({{$.GlobalData.CommitCount}})</a>
{{end -}}
{{end -}}
</div>
</div>
</div>
{{end -}}
{{if .TreeFound -}}
<div id="treelist">
<table>
<thead>
<tr>
<th class="left">Mode</th>
<th class="left">Name</th>
<th class="right">Size</th>
<th class="right">Last Modified</th>
<th class="left">Last Commit</th>
</tr>
</thead>
<tbody id="treeentries">
{{range .RootTree -}}
<tr>
<td class="left"><pre class="mode">{{.Mode -}}</pre></td>
<td class="left"><a {{if .IsFile -}}class="filelink"{{end -}}href="/{{$.GlobalData.Config.RepoName -}}{{.Link -}}">{{.Name -}}</a></td>
<td class="right"><pre class="size">{{if .IsFile}}{{.Size}}{{end -}}</pre></td>
<td class="right"><pre class="date">{{formatDate .LastModified -}}</pre></td>
<td class="left">{{if .LastCommitMsg -}}<a href="/{{$.GlobalData.Config.RepoName -}}{{.LastCommitLink -}}">{{.LastCommitMsg -}}</a>{{end -}}</td>
</tr>
{{end -}}
</tbody>
</table> 
</div>
{{end -}}
{{if .ReadmeFound -}}
{{if .ReadmeIsMarkdown -}}
<div class="fileview">
<div class="fileinfo">
<div class="fileinfo-left">
<p class="filename">{{.ReadmeFile.Name}}</p>
</div>
<div class="fileinfo-right">
{{if .ReadmeFile.LastCommitMsg -}}
<p class="commit-info">
<a href="/{{.GlobalData.Config.RepoName}}{{.ReadmeFile.LastCommitLink}}">{{.ReadmeFile.LastCommitMsg}}</a>
<small> · {{.ReadmeFile.LastCommitAuthor}} · {{timeAgo .ReadmeFile.LastCommitDate}}</small>
</p>
{{- end}}
</div>
</div>
<div class="readme-markdown">
{{.ReadmeHTML}}
</div>
</div>
{{else -}}
{{template "fileview.html" .ReadmeFile -}}
{{end -}}
{{end -}}
{{if .LicenseFound -}}
{{template "fileview.html" .LicenseFile -}}
{{end -}}
</div>
<div class="sidebar">
{{if gt .ContributorsCt 0 -}}
<div id="contributors">
<h3>Contributors ({{.ContributorsCt}})</h3>
<ul>
{{range .Contributors -}}
<li>{{.Name}} &lt;{{.Email}}&gt;</li>
{{end -}}
</ul>
</div>
{{end -}}
</div>
</div>
{{template "footer.html" . -}}
